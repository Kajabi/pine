<!-- @see https://storybook.js.org/docs/html/configure/story-rendering#adding-to-head -->
<script type="module" src="/pine-core/pine-core.esm.js"></script>
<script nomodule src="/pine-core/index.esm.js"></script>

<link rel="stylesheet" href="/pine-core/pine-core.css" />

<script>
  // Apply theme attribute to document
  const applyTheme = (theme) => {
    document.documentElement.setAttribute('data-theme', theme);
    if (document.body) {
      document.body.setAttribute('data-theme', theme);
    }
  };

  // Get theme from URL globals parameter (Storybook encodes globals in URL)
  const getThemeFromUrl = () => {
    const url = new URL(window.location.href);
    const globals = url.searchParams.get('globals');
    if (globals) {
      // Parse globals format: "theme:dark" or "theme:light;other:value"
      const parts = globals.split(';');
      for (const part of parts) {
        const [key, value] = part.split(':');
        if (key === 'theme' && value) {
          return value;
        }
      }
    }
    return 'light';
  };

  // Apply theme from URL
  const checkAndApplyTheme = () => {
    const theme = getThemeFromUrl();
    applyTheme(theme);
  };

  // Watch for URL changes (when user toggles theme in toolbar)
  let lastUrl = window.location.href;
  const urlObserver = setInterval(() => {
    if (window.location.href !== lastUrl) {
      lastUrl = window.location.href;
      checkAndApplyTheme();
    }
  }, 100);

  // Apply immediately
  checkAndApplyTheme();

  // Re-apply once body is available
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', checkAndApplyTheme);
  }
</script>


<style>
body {
    background-color: var(--pine-color-background-app);
  }

  .sb-unstyled {
    background-color: var(--pine-color-background-app);
  }

  /* Dark mode styles for Storybook docs */
  [data-theme="dark"] .sbdocs,
  [data-theme="dark"] .docs-story {
    background-color: #1a1a1a;
    color: #e0e0e0;
  }

  [data-theme="dark"] .sbdocs-wrapper {
    background-color: #1a1a1a;
  }

  [data-theme="dark"] .sbdocs-content {
    background-color: #1a1a1a;
    color: #e0e0e0;
  }

  [data-theme="dark"] .docblock-argstable .docblock-argstable-body > tr > * {
    background-color: #2d2d2d;
  }

  /* Docs headings */
  [data-theme="dark"] .sbdocs h1,
  [data-theme="dark"] .sbdocs h2,
  [data-theme="dark"] .sbdocs h3,
  [data-theme="dark"] .sbdocs h4,
  [data-theme="dark"] .sbdocs h5,
  [data-theme="dark"] .sbdocs h6 {
    color: #ffffff;
  }

  /* Docs paragraphs and text */
  [data-theme="dark"] .sbdocs p,
  [data-theme="dark"] .sbdocs li,
  [data-theme="dark"] .sbdocs span {
    /* color: #d0d0d0; */
    color: #e0e0e0;;
  }

  /* Docs links */
  [data-theme="dark"] .sbdocs a {
    color: #6b9f36;
  }

  [data-theme="dark"] .sbdocs a:hover {
    color: #8bc34a;
  }

  /* Docs code blocks */
  [data-theme="dark"] .sbdocs pre,
  [data-theme="dark"] .sbdocs code {
    background-color: #2d2d2d;
    color: #e0e0e0;
  }

  [data-theme="dark"] .sbdocs pre {
    border-color: #404040;
  }

  /* Docs tables */
  [data-theme="dark"] .sbdocs table {
    background-color: #252525;
  }

  [data-theme="dark"] .sbdocs th {
    background-color: #2d2d2d;
    color: #ffffff;
    border-color: #404040;
  }

  [data-theme="dark"] .sbdocs td {
    border-color: #404040;
    color: #d0d0d0;
  }

  [data-theme="dark"] .sbdocs tr:nth-child(even) {
    background-color: #2a2a2a;
  }

  /* Docs blockquotes */
  [data-theme="dark"] .sbdocs blockquote {
    background-color: #252525;
    border-left-color: #6b9f36;
    color: #b0b0b0;
  }

  /* Docs horizontal rules */
  [data-theme="dark"] .sbdocs hr {
    border-color: #404040;
  }

  /* ArgTypes/Props table */
  [data-theme="dark"] .docblock-argstable {
    background-color: #252525;
  }

  [data-theme="dark"] .docblock-argstable th,
  [data-theme="dark"] .docblock-argstable td {
    border-color: #404040;
    color: #d0d0d0;
  }

  [data-theme="dark"] .docblock-argstable thead {
    background-color: #2d2d2d;
  }

  [data-theme="dark"] .docblock-argstable thead th {
    color: #ffffff;
  }

  /* Story canvas/preview area */
  [data-theme="dark"] .innerZoomElementWrapper > div {
    background-color: #1a1a1a;
  }

  /* Unstyled stories container */
  [data-theme="dark"] .sb-unstyled {
    background-color: #1a1a1a;
  }

  [data-theme="dark"] .args-table {
    background-color: #1a1a1a;
  }

  [data-theme="dark"] .sbdocs-content .args-table-header {
    color: #e0e0e0;
  }

  [data-theme="dark"] .sbdocs-content .arg-table-cell {
    color: #e0e0e0;
  }

  [data-theme="dark"] .sbdocs-content .docblock-argstable-body button + span {
    color: #2e3338;
  }

  [data-theme="dark"] .sbdocs-content .docblock-argstable-body input + span + span {
    color: #2e3338;
  }
</style>